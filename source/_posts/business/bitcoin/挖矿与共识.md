---
title: 挖矿与公式
date: 2018-02-01 13:29:12
categories: [business, bitcoin]
---

<!-- TOC -->

- [1. 难度公式](#1-难度公式)
- [2. 算力增长](#2-算力增长)
- [3. 随机源](#3-随机源)
- [4. 挖矿案例](#4-挖矿案例)
- [5. 硬软分叉](#5-硬软分叉)

<!-- /TOC -->

<a id="markdown-1-难度公式" name="1-难度公式"></a>
# 1. 难度公式

* https://en.bitcoin.it/wiki/Difficulty#What_is_.22difficulty.22.3F
* https://blockexplorer.com/api/status?q=getDifficulty (获取难度)

```c++
难度公式:

实际消耗时间固定在[14/4, 14*4],也就是[3.5, 56]天内,4是因子,每次调整难度最多难4倍或最多容易4倍. (是为了防止难度的变化过快)

最小难度为:
consensus.powLimit = uint256S("00000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffff");

nBits = nBits * (最近2016个块的实际时间 / 20160 分钟)

```

```python
# 难度表示, 例如难度nBits == 0x1903a30c
# 前两位十六进制数字为幂(exponent)
# 接下来六位为系数(coefficient)

target = 幂 * 2^(8 * (系数 - 3))

target = 0x03a30c * 2 ** (0x08 * (0x19 - 3))
target_str = '%X' % target
target_str = "0x" +  "0" * (64 - len(target_str)) + target_str

```

<a id="markdown-2-算力增长" name="2-算力增长"></a>
# 2. 算力增长

* Y 尧 10^24
* Z 泽 10^21
* E 艾 10^18
* P 拍 10^15
* T 太 10^12
* G 吉 10^9
* M 兆 10^6
* K 千 10^3

---


* 2009 0.5 MH/sec–8 MH/sec (16× growth)
* 2010 8 MH/sec–116 GH/sec (14,500× growth)
* 2011 16 GH/sec–9 TH/sec (562× growth)
* 2012 9 TH/sec–23 TH/sec (2.5× growth)
* 2013 23 TH/sec–10 PH/sec (450× growth)
* 2014 10 PH/sec–300 PH/sec (3000× growth)
* 2015 300 PH/sec-800 PH/sec (266× growth)
* 2016 800 PH/sec-2.5 EH/sec (312× growth))


---

* 2010 ~ 2011 CPU 过度到GPU
* 2011 ~ 2013 过度到FPGA
* 2013后 ASIC

<a id="markdown-3-随机源" name="3-随机源"></a>
# 3. 随机源


* 早期通过`遍历随机数(Nonce)`获得符合要求的hash来挖出一个块
* 难度增长后,尝试了40亿个值仍然没有出块 --- `变化区块头的时间戳`
* 当挖矿硬件的速度到达了4GH/秒,时间戳+nonce的取值在一秒就被用尽了.很快达到TH/秒速率后,`时间戳延后` (不能延的太多)
* `coinbase交易`作为`额外`的`随机值来源`,因为coinbase脚本可以存储`2-100字节`的数据

8个`额外`的随机数(coinbase脚本的修改导致merkle树根的修改) 加上4个字节的`标准`的随机数(nonce),允许用户尝试`2^96`种可能性而`无需修改时间戳`

<a id="markdown-4-挖矿案例" name="4-挖矿案例"></a>
# 4. 挖矿案例

假设一名矿工已经购买了算力共14,000GH/S,或`14TH/S`,在2017年,它的价值大约`2500美元`.

运行功率为`1.3千瓦`(kw),每日耗电32度

<a id="markdown-5-硬软分叉" name="5-硬软分叉"></a>
# 5. 硬软分叉

* https://bitcoin.org/en/glossary/hard-fork
* https://bitcoin.org/en/glossary/soft-fork
